package uk.ac.ebi.pride.spectracluster.io;

import org.junit.*;

import java.io.*;

/**
 * uk.ac.ebi.pride.spectracluster.io.ParserUtilitiesTests
 * User: Steve
 * Date: 8/28/2014
 */
public class ParserUtilitiesTests {

    public static final String TEST_MGF =
            "BEGIN IONS\n" +
                    "TITLE=id=PRD000178;PRIDE_Exp_Complete_Ac_10639.xml;spectrum=1\n" +
                    "PEPMASS=453.6444091796875\n" +
                    "CHARGE=2.0+\n" +
                    "SEQ=GVSVSSAR\n" +
                    "TAXONOMY=9606\n" +
                    "USER02=IPI_human:IPI00479145\n" +
                    "101.065\t214.700\n" +
                    "112.067\t590.900\n" +
                    "113.065\t288.000\n" +
                    "114.087\t4044.000\n" +
                    "115.084\t4962.000\n" +
                    "116.080\t1515.000\n" +
                    "117.090\t1911.000\n" +
                    "120.058\t646.800\n" +
                    "129.076\t332.500\n" +
                    "143.066\t214.700\n" +
                    "145.078\t515.100\n" +
                    "147.070\t105.300\n" +
                    "157.062\t400.000\n" +
                    "158.060\t1106.000\n" +
                    "159.065\t557.200\n" +
                    "174.100\t1703.000\n" +
                    "175.081\t2715.000\n" +
                    "187.069\t467.500\n" +
                    "202.087\t2527.000\n" +
                    "203.082\t230.900\n" +
                    "207.071\t252.900\n" +
                    "226.070\t290.100\n" +
                    "228.049\t272.500\n" +
                    "229.081\t633.000\n" +
                    "244.078\t505.500\n" +
                    "246.102\t479.100\n" +
                    "256.074\t196.500\n" +
                    "273.145\t1039.000\n" +
                    "274.108\t437.400\n" +
                    "291.152\t256.000\n" +
                    "298.091\t166.100\n" +
                    "301.132\t791.800\n" +
                    "313.088\t162.000\n" +
                    "315.113\t133.700\n" +
                    "316.094\t441.100\n" +
                    "325.108\t290.100\n" +
                    "333.113\t305.600\n" +
                    "343.096\t184.300\n" +
                    "360.155\t235.300\n" +
                    "368.099\t152.900\n" +
                    "370.139\t854.400\n" +
                    "371.133\t229.000\n" +
                    "372.121\t180.300\n" +
                    "385.101\t202.500\n" +
                    "386.106\t169.100\n" +
                    "388.146\t1022.000\n" +
                    "389.148\t204.600\n" +
                    "402.126\t191.400\n" +
                    "403.105\t523.400\n" +
                    "404.109\t124.600\n" +
                    "420.127\t634.200\n" +
                    "421.129\t134.700\n" +
                    "452.656\t110.400\n" +
                    "453.146\t160.000\n" +
                    "455.144\t90.130\n" +
                    "457.179\t90.130\n" +
                    "459.205\t280.800\n" +
                    "469.184\t546.600\n" +
                    "470.184\t126.600\n" +
                    "487.190\t478.100\n" +
                    "488.183\t138.700\n" +
                    "502.149\t134.700\n" +
                    "503.158\t44.560\n" +
                    "517.153\t41.520\n" +
                    "519.171\t466.500\n" +
                    "520.176\t140.800\n" +
                    "544.183\t70.890\n" +
                    "556.193\t519.500\n" +
                    "558.192\t49.620\n" +
                    "574.204\t298.400\n" +
                    "575.196\t91.140\n" +
                    "588.179\t182.300\n" +
                    "589.171\t164.100\n" +
                    "606.184\t1458.000\n" +
                    "607.184\t398.700\n" +
                    "608.188\t98.230\n" +
                    "625.205\t261.100\n" +
                    "626.201\t80.000\n" +
                    "633.215\t53.670\n" +
                    "643.208\t343.900\n" +
                    "649.152\t9.114\n" +
                    "657.233\t6.076\n" +
                    "678.195\t94.180\n" +
                    "687.222\t110.400\n" +
                    "705.231\t723.000\n" +
                    "706.228\t212.700\n" +
                    "707.236\t61.770\n" +
                    "732.234\t166.100\n" +
                    "744.229\t394.500\n" +
                    "744.729\t3.038\n" +
                    "745.221\t304.600\n" +
                    "747.209\t27.340\n" +
                    "748.481\t2.025\n" +
                    "759.233\t87.090\n" +
                    "760.231\t170.100\n" +
                    "762.231\t3796.000\n" +
                    "763.231\t1339.000\n" +
                    "764.240\t364.500\n" +
                    "765.496\t10.130\n" +
                    "767.223\t17.220\n" +
                    "792.216\t10.130\n" +
                    "906.256\t9.114\n" +
                    "END IONS\n";

    public static final String TEST_MGF2 =
             "BEGIN IONS\n" +
                     "TITLE=id=PRD000178;PRIDE_Exp_Complete_Ac_10639.xml;spectrum=1\n" +
                     "PEPMASS=453.6444091796875\n" +
                     "CHARGE=2.0+\n" +
                     "SEQ=GVSVSSAR\n" +
                     "TAXONOMY=9606\n" +
                     "USER02=Uniprot_Z_mays_20091203.fasta:tr|Q8W233|Q8W233_MAIZE Putative non-LTR retroelement reverse transcriptase OS=Z\n" +
                     "101.065\t214.700\n" +
                     "112.067\t590.900\n" +
                     "113.065\t288.000\n" +
                     "114.087\t4044.000\n" +
                     "115.084\t4962.000\n" +
                     "116.080\t1515.000\n" +
                     "117.090\t1911.000\n" +
                     "120.058\t646.800\n" +
                     "129.076\t332.500\n" +
                     "143.066\t214.700\n" +
                     "145.078\t515.100\n" +
                     "147.070\t105.300\n" +
                     "157.062\t400.000\n" +
                     "158.060\t1106.000\n" +
                     "159.065\t557.200\n" +
                     "174.100\t1703.000\n" +
                     "175.081\t2715.000\n" +
                     "187.069\t467.500\n" +
                     "202.087\t2527.000\n" +
                     "203.082\t230.900\n" +
                     "207.071\t252.900\n" +
                     "226.070\t290.100\n" +
                     "228.049\t272.500\n" +
                     "229.081\t633.000\n" +
                     "244.078\t505.500\n" +
                     "246.102\t479.100\n" +
                     "256.074\t196.500\n" +
                     "273.145\t1039.000\n" +
                     "274.108\t437.400\n" +
                     "291.152\t256.000\n" +
                     "298.091\t166.100\n" +
                     "301.132\t791.800\n" +
                     "313.088\t162.000\n" +
                     "315.113\t133.700\n" +
                     "316.094\t441.100\n" +
                     "325.108\t290.100\n" +
                     "333.113\t305.600\n" +
                     "343.096\t184.300\n" +
                     "360.155\t235.300\n" +
                     "368.099\t152.900\n" +
                     "370.139\t854.400\n" +
                     "371.133\t229.000\n" +
                     "372.121\t180.300\n" +
                     "385.101\t202.500\n" +
                     "386.106\t169.100\n" +
                     "388.146\t1022.000\n" +
                     "389.148\t204.600\n" +
                     "402.126\t191.400\n" +
                     "403.105\t523.400\n" +
                     "404.109\t124.600\n" +
                     "420.127\t634.200\n" +
                     "421.129\t134.700\n" +
                     "452.656\t110.400\n" +
                     "453.146\t160.000\n" +
                     "455.144\t90.130\n" +
                     "457.179\t90.130\n" +
                     "459.205\t280.800\n" +
                     "469.184\t546.600\n" +
                     "470.184\t126.600\n" +
                     "487.190\t478.100\n" +
                     "488.183\t138.700\n" +
                     "502.149\t134.700\n" +
                     "503.158\t44.560\n" +
                     "517.153\t41.520\n" +
                     "519.171\t466.500\n" +
                     "520.176\t140.800\n" +
                     "544.183\t70.890\n" +
                     "556.193\t519.500\n" +
                     "558.192\t49.620\n" +
                     "574.204\t298.400\n" +
                     "575.196\t91.140\n" +
                     "588.179\t182.300\n" +
                     "589.171\t164.100\n" +
                     "606.184\t1458.000\n" +
                     "607.184\t398.700\n" +
                     "608.188\t98.230\n" +
                     "625.205\t261.100\n" +
                     "626.201\t80.000\n" +
                     "633.215\t53.670\n" +
                     "643.208\t343.900\n" +
                     "649.152\t9.114\n" +
                     "657.233\t6.076\n" +
                     "678.195\t94.180\n" +
                     "687.222\t110.400\n" +
                     "705.231\t723.000\n" +
                     "706.228\t212.700\n" +
                     "707.236\t61.770\n" +
                     "732.234\t166.100\n" +
                     "744.229\t394.500\n" +
                     "744.729\t3.038\n" +
                     "745.221\t304.600\n" +
                     "747.209\t27.340\n" +
                     "748.481\t2.025\n" +
                     "759.233\t87.090\n" +
                     "760.231\t170.100\n" +
                     "762.231\t3796.000\n" +
                     "763.231\t1339.000\n" +
                     "764.240\t364.500\n" +
                     "765.496\t10.130\n" +
                     "767.223\t17.220\n" +
                     "792.216\t10.130\n" +
                     "906.256\t9.114\n" +
                     "END IONS\n";
    @Test
    public void testParseMGF() throws Exception {
        InputStream is = new StringBufferInputStream(TEST_MGF);
        ParserUtilities.guaranteeMGFParse(is);
    }
    @Test
      public void testParseMGF2() throws Exception {
          InputStream is = new StringBufferInputStream(TEST_MGF2);
          ParserUtilities.guaranteeMGFParse(is);
      }
  }
